<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coze Workflow API 调用</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
            background-color: #f9f9f9;
        }
        .container {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #1a73e8;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        textarea {
            width: 100%;
            min-height: 250px;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-size: 16px;
            resize: vertical;
            box-sizing: border-box; /* 确保 padding 不会影响宽度 */
        }
        button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #1a73e8;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        button:hover:not(:disabled) {
            background-color: #1558b8;
        }
        button:disabled {
            background-color: #9e9e9e;
            cursor: not-allowed;
        }
        .output-container {
            margin-top: 30px;
        }
        #response-output {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 4px;
            min-height: 100px;
            white-space: pre-wrap; /* 保持换行和空格 */
            word-wrap: break-word; /* 自动换行 */
            border: 1px solid #e0e0e0;
        }
        .warning {
            background-color: #fffbe5;
            border: 1px solid #ffde5c;
            color: #8c6d00;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>调用 Coze Workflow API</h1>

        <div class="warning">
            <strong>安全警告：</strong> 此示例将 API Key 直接写在前端代码中，仅适用于本地测试。请勿在生产环境中如此操作，否则会泄露您的密钥。在生产环境中，应通过后端服务器调用此 API。
        </div>

        <label for="script-text-input">请输入讲稿内容 (script_text):</label>
        <textarea id="script-text-input" placeholder="在这里输入或粘贴您的讲稿内容...">
主题： 拥抱变革：人工智能时代的我们如何与未来共舞

场合： 公司内部青年员工发展论坛

(讲稿初稿)

大家好，

今天我想和大家聊一个我们每个人都绕不开的话题：人工智能，以及它到底会怎么改变我们的工作。

首先，大家有没有发现，AI这个词，在几年前还只是电影里的科幻概念，但现在，它已经悄悄地进入了我们生活的方方面面。从我们手机上的智能助手，到今天我们开会用的这个自动生成字幕的软件，AI无处不在。很多人会感到焦虑，媒体上总是在说“某某岗位将被AI取代”。这种焦虑，我完全理解。

但是，我想说的是，我们不应该只看到挑战，更应该看到背后巨大的机遇。历史告诉我们，每一次技术革命，都不是为了简单地取代人类，而是为了增强人类。蒸汽机解放了我们的体力，计算机解放了我们的脑力，而人工智能，正在将我们从大量重复性的、繁琐的工作中解放出来，让我们能更专注于那些真正需要创造力、同理心和战略思维的工作。

这到底意味着什么呢？

第一，我们的工作内容会变。比如说，以前一个市场分析师，可能80%的时间都花在收集数据、清洗数据和制作图表上。现在，AI可以在几分钟内完成这些事。那么这位分析师就可以把他的全部精力，都投入到数据背后的洞察分析、市场策略的制定和与客户的深度沟通上。你看，他的工作没有消失，反而变得更有价值了。

第二，我们需要学习新技能。以前我们说“学会一门手艺，吃遍天”。现在不行了，未来的核心竞争力，不是你会什么，而是你学得有多快。我们需要学会如何“与AI协作”，学会提出正确的问题，让AI成为我们强大的副驾驶，而不是盯着后视镜，担心被它超车。我们需要培养批判性思维，这样才不会被AI生成的信息所迷惑。

所以，我们该怎么办呢？其实很简单。保持开放的心态，拥抱终身学习。不要害怕去尝试新的AI工具，把它当成一个能帮你干活的实习生。多花点时间去思考、去创造、去和我们的同事、客户进行有温度的连接。这些，恰恰是AI在短期内无法替代的。

最后，我想用一句话结束今天的分享：未来已来，它不是要淘汰我们，而是在邀请我们，去共同创造一个更智能、也更人性化的新世界。我们不应是变革的旁观者，而应是未来的共舞者。

谢谢大家！
</textarea>

        <button id="submit-btn" onclick="callCozeApi()">执行 Workflow</button>

        <div class="output-container">
            <label for="response-output">API 流式响应:</label>
            <pre id="response-output"></pre>
        </div>
    </div>

    <script>
        async function callCozeApi() {
            // 从页面元素获取数据
            const scriptText = document.getElementById('script-text-input').value;
            const submitButton = document.getElementById('submit-btn');
            const responseOutput = document.getElementById('response-output');

            // --- API 配置 ---
            // 警告：直接在前端暴露 API Key 是非常不安全的。这里仅为演示目的。
            const apiKey = "cztei_lb5ilcgdtPJTLKrhnHw7He2jpStus7rGgOV28EIvDTCBwCdDTZNJihpvO7QDDUlVY";
            const workflowId = "7551990489299451946";
            const apiUrl = "https://api.co.cn/v1/workflow/stream_run";

            // 简单的输入验证
            if (!scriptText.trim()) {
                alert("请输入讲稿内容！");
                return;
            }

            // 更新UI状态，准备发送请求
            submitButton.disabled = true;
            submitButton.textContent = "正在请求...";
            responseOutput.textContent = ""; // 清空上次的输出

            try {
                // 构建请求体
                const requestBody = {
                    workflow_id: workflowId,
                    parameters: {
                        script_text: scriptText
                    }
                };

                // 使用 fetch API 发送 POST 请求
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json',
                        'Accept': '*/*' // 接受任何类型的响应
                    },
                    body: JSON.stringify(requestBody)
                });

                // 检查响应状态
                if (!response.ok) {
                    throw new Error(`HTTP 错误！状态码: ${response.status}`);
                }
                
                // --- 处理流式响应 ---
                const reader = response.body.getReader();
                const decoder = new TextDecoder('utf-8');

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) {
                        break; // 数据流结束
                    }
                    // 将接收到的数据块 (Uint8Array) 解码为字符串并追加到输出区域
                    const chunk = decoder.decode(value, { stream: true });
                    responseOutput.textContent += chunk;
                }

            } catch (error) {
                // 捕获并显示错误信息
                console.error("API调用失败:", error);
                responseOutput.textContent = `发生错误：\n${error.message}`;
            } finally {
                // 无论成功或失败，都恢复按钮状态
                submitButton.disabled = false;
                submitButton.textContent = "执行 Workflow";
            }
        }
    </script>

</body>
</html>
